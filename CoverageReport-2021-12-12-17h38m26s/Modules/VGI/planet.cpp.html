<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>planet.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
    <body onload="prettyPrint()">
        <h4></h4>
        <pre class="prettyprint lang-cpp linenums">
#define _USE_MATH_DEFINES
#include &lt;cmath&gt;
#include &lt;math.h&gt;

#include "planet.h"
#include "../util/util.h"

#include &lt;iostream&gt;


<span style = "background-color:#fdd">Planet::Planet(glm::vec3 coordinates, std::string texturePath) : Sphere(0.5f, 36, 18) {
    m_Coordinates = coordinates;
    m_Texture = util::LoadTexture(texturePath);
}</span>

<span style = "background-color:#fdd">Planet::Planet(float r, int sectors, int stacks, glm::vec3 coordinates, std::string texturePath) : Sphere(r, sectors, stacks) {
    m_Coordinates = coordinates;
    m_Texture = util::LoadTexture(texturePath);
}</span>

<span style = "background-color:#dfd">static float ComputeSphereRadius(YAML::Node values) {
    float radius = values["diameter"].as&lt;float&gt;() / 2;
    return radius / 10000000;
}</span>

<span style = "background-color:#dfd">static float ComputeAcademicSphereRadius(YAML::Node values) {
    float earth_radius = 6378;
    float radius = values["academic"].as&lt;float&gt;()*earth_radius;</span>

    //std::cout &lt;&lt; "Radius: " &lt;&lt; ((255 * log10(radius)) / 6) &lt;&lt; std::endl;

<span style = "background-color:#dfd">    return radius / 100000;
}</span>

<span style = "background-color:#dfd">Planet::Planet(YAML::Node values, std::string name, bool isAcademic) : Sphere(isAcademic ? ComputeAcademicSphereRadius(values) : ComputeSphereRadius(values), 36, 18) {
    m_Texture = util::LoadTexture(values["texture"].as&lt;std::string&gt;());
    m_Name = name;</span>

<span style = "background-color:#dfd">    std::vector&lt;float&gt; coordinates = values["coordinates"].as&lt;std::vector&lt;float&gt;&gt;();
    m_Coordinates = glm::vec3(coordinates[0], coordinates[1], coordinates[2]);
    m_K = values["k"].as&lt;int&gt;();
    float UA = 149597870.7;
    m_OrbitRadius = (UA * (0.4 + 0.3 * m_K)) / 10000000;</span>

<span style = "background-color:#dfd">    GenerateOrbit(m_OrbitRadius);
}</span>

<span style = "background-color:#dfd">void Planet::GenerateOrbit(float orbitRadius) {
    m_OrbitVertices.clear();</span>
    GLfloat xx, zz;
    float angl;
<span style = "background-color:#dfd">    for (int i = 0; i &lt; 2000; i++) {
        angl = (float)(M_PI / 2 - i * (M_PI / 1000));
        xx = sin(angl) * orbitRadius;
        zz = cos(angl) * orbitRadius;
        glm::vec3 coordinates = glm::vec3(xx, 0.0f, zz) * m_Coordinates;
        m_OrbitVertices.push_back(coordinates[0]);
        m_OrbitVertices.push_back(coordinates[1]);
        m_OrbitVertices.push_back(coordinates[2]);
    }</span>

<span style = "background-color:#dfd">    glGenVertexArrays(1, &amp;m_OrbitsVAO);
    glGenBuffers(1, &amp;m_OrbitsVBO);
    glBindVertexArray(m_OrbitsVAO);
    glBindBuffer(GL_ARRAY_BUFFER, m_OrbitsVBO);
    glBufferData(GL_ARRAY_BUFFER, sizeof(float) * m_OrbitVertices.size(), m_OrbitVertices.data(), GL_STATIC_DRAW);
    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 3 * sizeof(GLfloat), (GLvoid*)0);
    glEnableVertexAttribArray(0);
    glBindBuffer(GL_ARRAY_BUFFER, 0);
    glBindVertexArray(0);
}</span>

<span style = "background-color:#dfd">void Planet::Draw() {
    glActiveTexture(GL_TEXTURE0);
    glBindTexture(GL_TEXTURE_2D, m_Texture);
    Sphere::Draw();
}</span>

<span style = "background-color:#dfd">void Planet::DrawOrbit() {
    glBindVertexArray(m_OrbitsVAO);
    glLineWidth(1.0f);
    glDrawArrays(GL_LINE_LOOP, 0, (GLsizei)m_OrbitVertices.size() / 3);
}</span></pre>
        <hr />
        <table width="100%">
            <thead>
                <tr>
                    <th align="center">
                        <small>Generated by</small>
                        <a href="https://github.com/OpenCppCoverage/OpenCppCoverage/releases">
                            <strong>OpenCppCoverage (Version: 0.9.9.0)</strong>
                        </a>
                    </th>
                </tr>
            </thead>
        </table>
    </body>
</html>