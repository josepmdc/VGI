<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>depthguard.h</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
    <body onload="prettyPrint()">
        <h4></h4>
        <pre class="prettyprint lang-cpp linenums">
#ifndef DEPTH_GUARD_H_00000000000000000000000000000000000000000000000000000000
#define DEPTH_GUARD_H_00000000000000000000000000000000000000000000000000000000

#if defined(_MSC_VER) ||                                            \
    (defined(__GNUC__) &amp;&amp; (__GNUC__ == 3 &amp;&amp; __GNUC_MINOR__ &gt;= 4) || \
     (__GNUC__ &gt;= 4))  // GCC supports "pragma once" correctly since 3.4
#pragma once
#endif

#include "exceptions.h"

namespace YAML {

/**
 * @brief The DeepRecursion class
 *  An exception class which is thrown by DepthGuard. Ideally it should be
 * a member of DepthGuard. However, DepthGuard is a templated class which means
 * that any catch points would then need to know the template parameters. It is
 * simpler for clients to not have to know at the catch point what was the
 * maximum depth.
 */
class DeepRecursion : public ParserException {
public:
<span style = "background-color:#fdd">  virtual ~DeepRecursion() = default;</span>

  DeepRecursion(int depth, const Mark&amp; mark_, const std::string&amp; msg_);

  // Returns the recursion depth when the exception was thrown
  int depth() const {
    return m_depth;
  }

private:
  int m_depth = 0;
};

/**
 * @brief The DepthGuard class
 *  DepthGuard takes a reference to an integer. It increments the integer upon
 * construction of DepthGuard and decrements the integer upon destruction.
 *
 * If the integer would be incremented past max_depth, then an exception is
 * thrown. This is ideally geared toward guarding against deep recursion.
 *
 * @param max_depth
 *  compile-time configurable maximum depth.
 */
template &lt;int max_depth = 2000&gt;
class DepthGuard final {
public:
<span style = "background-color:#dfd">  DepthGuard(int &amp; depth_, const Mark&amp; mark_, const std::string&amp; msg_) : m_depth(depth_) {
    ++m_depth;
    if ( max_depth &lt;= m_depth ) {</span>
<span style = "background-color:#fdd">        throw DeepRecursion{m_depth, mark_, msg_};</span>
    }
<span style = "background-color:#dfd">  }</span>

  DepthGuard(const DepthGuard &amp; copy_ctor) = delete;
  DepthGuard(DepthGuard &amp;&amp; move_ctor) = delete;
  DepthGuard &amp; operator=(const DepthGuard &amp; copy_assign) = delete;
  DepthGuard &amp; operator=(DepthGuard &amp;&amp; move_assign) = delete;

<span style = "background-color:#dfd">  ~DepthGuard() {
    --m_depth;
  }</span>

  int current_depth() const {
    return m_depth;
  }

private:
    int &amp; m_depth;
};

} // namespace YAML

#endif // DEPTH_GUARD_H_00000000000000000000000000000000000000000000000000000000</pre>
        <hr />
        <table width="100%">
            <thead>
                <tr>
                    <th align="center">
                        <small>Generated by</small>
                        <a href="https://github.com/OpenCppCoverage/OpenCppCoverage/releases">
                            <strong>OpenCppCoverage (Version: 0.9.9.0)</strong>
                        </a>
                    </th>
                </tr>
            </thead>
        </table>
    </body>
</html>